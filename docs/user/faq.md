# よくある質問（FAQ）

Madaminalinkの使用中によくある質問とトラブルシューティングをまとめています。

## 📋 目次

- [一般的な質問](#一般的な質問)
- [コマンド関連](#コマンド関連)
- [権限とエラー](#権限とエラー)
- [パフォーマンス](#パフォーマンス)
- [トラブルシューティング](#トラブルシューティング)

---

## 一般的な質問

### Q1. Madaminalinkは無料で使えますか？

**A:** はい、完全無料です。オープンソース（MITライセンス）で提供されています。

サポートしたい場合は [FANBOX](https://minarin.fanbox.cc/) で開発者を支援できます。

---

### Q2. どのような権限が必要ですか？

**A:** Madaminalinkは以下の権限が必要です：

**必須権限:**
- チャンネルの閲覧
- チャンネルの管理
- ロールの管理
- メッセージの送信・管理
- メッセージ履歴の閲覧
- 埋め込みリンクとファイル添付
- スレッドの作成と管理

**推奨権限:**
- ボイスチャンネルへの接続
- メンバーの移動（`/gather` コマンド用）

招待リンクの管理者権限は便利ですが、必要に応じて個別の権限に調整可能です。

---

### Q3. プライベートBotとして自分でホストできますか？

**A:** はい、可能です。

1. [GitHubリポジトリ](https://github.com/minarin0179/Madaminalink_v2)をクローン
2. [開発環境構築ガイド](../developer/setup.md)に従ってセットアップ
3. [デプロイガイド](../developer/deployment.md)を参考に本番運用

---

### Q4. 対応言語は？

**A:** 現在は日本語のみです。

将来的に多言語対応を検討していますが、コントリビューションも歓迎しています。

---

## コマンド関連

### Q5. `/setup` で作成したチャンネルの権限を変更できますか？

**A:** はい、作成後に手動で変更できます。

また、カテゴリの権限を変更した後、`/sync` コマンドで配下の全チャンネルに一括適用できます。

```
/sync category:[カテゴリID]
```

---

### Q6. `/archive` の処理にどれくらい時間がかかりますか？

**A:** チャンネル数とメッセージ量に依存します：

- **小規模**（3チャンネル、計500メッセージ）: 約1〜2分
- **中規模**（10チャンネル、計2000メッセージ）: 約5〜10分
- **大規模**（20チャンネル、計5000メッセージ）: 約20〜30分

大きなエンティティはスキップされます。処理中はBotが応答しない場合がありますが、バックグラウンドで動作しています。

---

### Q7. `/copy` でコピーできるメッセージ数に制限はありますか？

**A:** メッセージ数に制限はありませんが、以下の制約があります：

- **添付ファイル**: 10MB以下のファイルのみコピー可能
- **レート制限**: Discord APIの制限により、大量のメッセージがある場合は時間がかかります
- **古いメッセージ**: 全て取得可能

---

### Q8. `/poll` で23個以上の選択肢を作れますか？

**A:** できません。Discordのボタン制限により、最大23個です。

**回避策:**
- 投票を複数回に分ける
- カテゴリごとに分割する

---

### Q9. `/remind` で過去の日時を指定するとどうなりますか？

**A:** エラーメッセージが表示され、リマインダーは作成されません。

日時形式は `YYYY/MM/DD HH:MM` で、必ず未来の時刻を指定してください。

---

### Q10. `/delete` が実行できません

**A:** 以下を確認してください：

1. **Bot参加後24時間経過しているか**
   - 安全機能により、参加直後は破壊的コマンドが制限されます

2. **十分な権限があるか**
   - チャンネル管理権限が必要です

3. **確認ボタンをクリックしたか**
   - 誤操作防止のため、確認が必要です

---

## 権限とエラー

### Q11. 「権限が不足しています」エラーが出ます

**A:** 以下を確認してください：

1. **Botロールの位置**
   - サーバー設定 → ロール で、Botのロールが操作対象より上にあるか確認
   - 例: キャラクターAロールを付与する場合、BotロールがキャラクターAより上位

2. **カテゴリ・チャンネルの権限**
   - 該当チャンネルの権限設定で、Botが必要な権限を持っているか確認

3. **管理者権限の有無**
   - 確実に動作させたい場合は、Botに管理者権限を付与

**よくあるケース:**
```
エラー: ロール @キャラクターA を付与できません
→ Botのロールをキャラクターロールより上に移動
```

---

### Q12. 「Unknown Interaction」エラーが表示されます

**A:** このエラーは、Botの応答が3秒を超えた場合に発生します。

**原因:**
- サーバーの高負荷
- ネットワークの遅延
- 処理対象が大きすぎる（大量のメッセージなど）

**対処法:**
- 少し待ってから再試行
- 処理を小分けにする（例: `/copy` を1チャンネルずつ実行）

---

### Q13. ボタンやメニューが反応しません

**A:** 以下を確認してください：

1. **ボタンの有効期限**
   - 古いメッセージのボタンは無効になっている場合があります
   - コマンドを再実行して新しいボタンを作成

2. **Botのオンライン状態**
   - Botがオフラインの場合、ボタンは反応しません

3. **権限**
   - ボタンを押す権限があるか確認

---

## パフォーマンス

### Q14. Botの応答が遅いです

**A:** 以下の要因が考えられます：

1. **シャーディング**
   - 大規模サーバーでは、Botがシャードを起動中の可能性があります（数分待つ）

2. **処理の重さ**
   - `/archive` や `/copy` など、大量のデータを扱うコマンドは時間がかかります

3. **Discordのレート制限**
   - 連続して多くのコマンドを実行すると、一時的に制限されます

**改善方法:**
- コマンドの実行間隔を空ける
- 処理を小分けにする

---

### Q15. メッセージのコピーが途中で止まります

**A:** 以下を確認してください：

1. **Botの権限**
   - 途中でチャンネルへのアクセス権を失っていないか

2. **Discord APIの制限**
   - レート制限により、自動的に待機している可能性があります（継続して処理されます）

3. **エラーログ**
   - エラーメッセージが表示されていないか確認

---

## トラブルシューティング

### Q16. `/setup` で作成したロールが機能しません

**A:** 以下を確認してください：

1. **ロールの権限設定**
   - サーバー設定 → ロール で、作成されたロールの権限を確認
   - 必要に応じて手動で調整

2. **ロールの割り当て**
   - `/role add` または `/role change` で、メンバーにロールを割り当て

---

### Q17. アーカイブしたスレッドが見つかりません

**A:** 以下を確認してください：

1. **アーカイブチャンネル**
   - デフォルトでは「📚アーカイブ」チャンネルが作成されます
   - チャンネル一覧で確認

2. **スレッドの表示設定**
   - チャンネル内で「スレッド」タブを開く
   - アーカイブ済みスレッドも表示する設定になっているか確認

3. **プライベートスレッド**
   - プライベートチャンネルはプライベートスレッドとしてアーカイブされます
   - 適切な権限がないと見えません

---

### Q18. `/poll` の投票結果が表示されません

**A:** 以下を試してください：

1. **「集計」ボタンをクリック**
   - 投票メッセージの下にある「集計」ボタンを押すと結果が表示されます

2. **投票の終了**
   - 全員が投票を完了しているか確認

3. **データベース接続**
   - Botが正常に動作しているか確認（`/ping` で確認可能）

---

### Q19. コマンドが表示されません

**A:** 以下を確認してください：

1. **Botの招待時のスコープ**
   - `applications.commands` スコープが含まれているか確認
   - 含まれていない場合は、Botを再招待

2. **サーバーへの再招待**
   - 最新の招待リンクで再度Botを招待

3. **Discord クライアントの再起動**
   - スラッシュコマンドのキャッシュをクリア

---

### Q20. メッセージが削除できません

**A:** 以下を確認してください：

1. **メッセージの投稿日時**
   - 14日以上前のメッセージは一括削除できません（Discord仕様）
   - `/cleanup` は古いメッセージを個別に削除しますが、時間がかかります

2. **権限**
   - メッセージ管理権限があるか確認

3. **Botのメッセージ**
   - Botが投稿したメッセージは削除できますが、他のBotのメッセージは削除できない場合があります

---

## 💬 サポート

### 解決しない場合

上記で解決しない場合は、以下のリソースを活用してください：

1. **公式サポートサーバー**
   - [Discord サポートサーバー](https://discord.gg/JMqcQstFSK)
   - GMやユーザーコミュニティに質問できます

2. **GitHub Issues**
   - [Issue を作成](https://github.com/minarin0179/Madaminalink_v2/issues)
   - バグ報告や機能リクエストを送信

3. **詳細ガイド**
   - [note.com の使い方ガイド](https://note.com/minarin/n/n7c1a2ce8a08f)
   - より詳細な解説があります

### 報告時に含めるべき情報

- 実行したコマンド
- エラーメッセージの全文
- 発生した状況（どのような操作をしたか）
- サーバーの規模（メンバー数、チャンネル数）
- 使用しているクライアント（デスクトップ/モバイル）

---

## 📖 関連ドキュメント

- [導入ガイド](./getting-started.md) - 初期セットアップ
- [コマンドリファレンス](./commands-reference.md) - コマンドの詳細
- [ユースケース](./use-cases.md) - 実践的な活用例
