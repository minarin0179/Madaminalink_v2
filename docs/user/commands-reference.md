# コマンドリファレンス

Madaminalinkが提供する全コマンドの詳細なリファレンスです。

## 📋 目次

- [セットアップコマンド](#セットアップコマンド)
- [チャンネル管理コマンド](#チャンネル管理コマンド)
- [ロール管理コマンド](#ロール管理コマンド)
- [ゲーム機能コマンド](#ゲーム機能コマンド)
- [メッセージ管理コマンド](#メッセージ管理コマンド)
- [ユーティリティコマンド](#ユーティリティコマンド)
- [コンテキストメニューコマンド](#コンテキストメニューコマンド)

---

## セットアップコマンド

### `/setup`

ゲーム用のカテゴリとチャンネルを自動作成します。

**オプション:**
- `category-name` - カテゴリ名（デフォルト: "GM専用"）
- `text-channels` - テキストチャンネル名（カンマ区切り）
- `voice-channels` - ボイスチャンネル名（カンマ区切り）
- `roles` - ロール名（カンマ区切り、自動作成）

**使用例:**
```
/setup category-name:第1回公演 text-channels:全体,個別1,個別2 roles:参加者,観覧者
```

**作成されるもの:**
- 指定したカテゴリ
- 各テキストチャンネル
- 各ボイスチャンネル
- 指定したロール（権限設定済み）

---

## チャンネル管理コマンド

### `/copy`

チャンネルまたはカテゴリを、メッセージと添付ファイルを含めてコピーします。

**オプション:**
- `target` - コピー元（チャンネルまたはカテゴリID）
- `new-name` - 新しい名前（オプション）
- `include-messages` - メッセージをコピーするか（デフォルト: true）

**使用例:**
```
/copy target:123456789 new-name:第2回公演
```

**機能:**
- チャンネル設定（トピック、NSFW、スローモードなど）をコピー
- 権限設定を複製
- メッセージ履歴をコピー（最大10MBの添付ファイル対応）
- カテゴリ全体の複製に対応

---

### `/delete`

カテゴリ内の全チャンネルを一括削除します。

**オプション:**
- `category` - 削除対象のカテゴリ

**使用例:**
```
/delete category:123456789
```

⚠️ **警告:**
- 確認ボタンが表示されます
- Bot参加後24時間は実行不可
- 削除は取り消せません

---

### `/cleanup`

指定したチャンネル内の全メッセージを削除します。

**オプション:**
- `channel` - 対象チャンネル（省略時は現在のチャンネル）

**使用例:**
```
/cleanup
/cleanup channel:#全体連絡
```

⚠️ **注意:**
- 14日以上前のメッセージは一括削除できません（Discord仕様）
- 古いメッセージがある場合は個別に削除されます

---

### `/archive`

カテゴリまたはチャンネルをスレッドアーカイブに変換します。

**オプション:**
- `target` - アーカイブ対象（チャンネルまたはカテゴリID）
- `archive-channel` - アーカイブ先チャンネル（省略時は自動作成）

**使用例:**
```
/archive target:123456789
```

**機能:**
- 各チャンネルを個別のスレッドに変換
- メッセージ履歴を保持（2000文字ごとに分割）
- 添付ファイルも含めてアーカイブ
- プライベート・アーカイブされたスレッドも取得

⚠️ **制限:**
- 大きなエンティティはスキップされます

---

### `/sync`

カテゴリの権限設定を配下の全チャンネルに同期します。

**オプション:**
- `category` - 対象カテゴリ

**使用例:**
```
/sync category:123456789
```

---

### `/open`

チャンネルを公開するボタンを作成します。

**オプション:**
- `channel` - 公開するチャンネル
- `role` - アクセスを許可するロール

**使用例:**
```
/open channel:#秘密部屋 role:@参加者
```

**動作:**
- ボタンをクリックした時点で、指定ロールにチャンネルが表示されるようになります

---

## ロール管理コマンド

### `/role add`

ロール付与ボタンを作成します。

**オプション:**
- `role` - 付与するロール
- `message` - ボタンに表示するメッセージ
- `channel` - ボタンを送信するチャンネル（オプション）

**使用例:**
```
/role add role:@参加者 message:参加者ロールを取得
```

---

### `/role remove`

ロール削除ボタンを作成します。

**オプション:**
- `role` - 削除するロール
- `message` - ボタンに表示するメッセージ

**使用例:**
```
/role remove role:@参加者 message:参加者ロールを解除
```

---

### `/role change`

ロール切り替えセレクトメニューを作成します。

**オプション:**
- `roles` - 切り替え可能なロール（カンマ区切り）
- `message` - メニューに表示するメッセージ

**使用例:**
```
/role change roles:@キャラA,@キャラB,@キャラC message:キャラクターを選択
```

---

### `/rename`

サーバーメンバーのニックネームを一括リセットします。

**使用例:**
```
/rename
```

**機能:**
- 確認ボタンが表示されます
- 全メンバーのニックネームをユーザー名に戻します
- Bot自身と管理者は除外されます

---

## ゲーム機能コマンド

### `/poll`

投票やキャラクター選択を実施します。

**オプション:**
- `title` - 投票のタイトル
- `choices` - 選択肢（カンマ区切り、最大23個）
- `allow-change` - 投票変更を許可（デフォルト: false）
- `show-voters` - 投票者を表示（デフォルト: false）
- `role` - メンション対象ロール（オプション）

**使用例:**
```
/poll title:キャラクター選択 choices:キャラA,キャラB,キャラC allow-change:true
```

**機能:**
- ボタンで投票
- 重複投票の防止
- 投票結果の集計と表示
- 決選投票機能

---

### `/dice`

ダイスロールボタンを作成します。

**オプション:**
- `dice` - ダイス記法（例: 2d6, 1d20）
- `message` - ボタンに表示するメッセージ

**使用例:**
```
/dice dice:2d6 message:調査判定
```

**対応形式:**
- `xdy` - x個のy面ダイスを振る（例: 3d6）
- 結果は合計値と各ダイスの目が表示されます

---

### `/order`

順序管理（発言順など）を行います。

**サブコマンド:**

#### `/order create`
順序リストを作成します。

**オプション:**
- `title` - リストのタイトル
- `members` - メンバー（カンマ区切り）
- `shuffle` - シャッフルするか（デフォルト: false）

**使用例:**
```
/order create title:発言順 members:@ユーザーA,@ユーザーB,@ユーザーC shuffle:true
```

#### `/order join`
既存の順序リストに参加します（メンション形式のみ）。

#### `/order delete`
順序リストを削除します。

**オプション:**
- `message-id` - 削除する順序メッセージのID

---

### `/gather`

他のボイスチャンネルからメンバーを現在のチャンネルに移動します。

**オプション:**
- `from-channel` - 移動元のボイスチャンネル（省略時は全チャンネル）

**使用例:**
```
/gather
/gather from-channel:待機室
```

**前提条件:**
- コマンド実行者がボイスチャンネルに接続している必要があります

---

### `/remind`

リマインダーを設定します。

**オプション:**
- `message` - リマインドするメッセージ
- `time` - 実行時刻（形式: YYYY/MM/DD HH:MM）
- `channel` - 送信先チャンネル（省略時は現在のチャンネル）
- `role` - メンション対象ロール（オプション）

**使用例:**
```
/remind message:ゲーム開始です time:2024/12/25 20:00 role:@参加者
```

**機能:**
- 指定時刻にメッセージを自動送信
- ロールメンション可能
- リマインダーの削除ボタン付き

---

## メッセージ管理コマンド

### `/transfer`

メッセージを別のチャンネルに転送します。

**オプション:**
- `from` - 転送元の最初のメッセージID
- `to` - 転送元の最後のメッセージID（オプション）
- `destination` - 転送先チャンネル（オプション、セレクトメニューで選択可）

**使用例:**
```
/transfer from:123456789 to:987654321 destination:#転送先
```

**機能:**
- 範囲指定でメッセージを転送
- 添付ファイルも含めて転送（最大10MB）
- 転送順序を維持

---

### `/log`

メッセージのログを取得します。

**サブコマンド:**

#### `/log get`
指定範囲のメッセージをテキストファイルで取得します。

**オプション:**
- `from` - 開始メッセージID
- `to` - 終了メッセージID（オプション）
- `channel` - 対象チャンネル（省略時は現在のチャンネル）

**使用例:**
```
/log get from:123456789 to:987654321
```

---

## ユーティリティコマンド

### `/ping`

Botの応答速度を確認します。

**使用例:**
```
/ping
```

**表示内容:**
- API レイテンシ
- WebSocket ping

---

### `/server`

サーバーの統計情報を表示します。

**使用例:**
```
/server
```

**表示内容:**
- メンバー数（ユーザー/Bot）
- ロール数
- チャンネル数（テキスト/ボイス/スレッド）
- 絵文字/ステッカー数
- サーバーブースト状況

---

## コンテキストメニューコマンド

コンテキストメニューコマンドは、メッセージやユーザーを右クリックして実行できます。

### メッセージ関連

#### 「メッセージを編集」
選択したメッセージの内容を編集します（Bot自身のメッセージのみ）。

#### 「このメッセージより前を削除」
選択したメッセージより前のメッセージを全削除します。

#### 「このメッセージより後を削除」
選択したメッセージより後のメッセージを全削除します。

#### 「このメッセージから転送」
選択したメッセージを起点に転送します。

#### 「アーカイブを修正」
アーカイブスレッドのエラーを修正します。

### ユーザー関連

#### 「ニックネームをリセット」
選択したユーザーのニックネームをユーザー名に戻します。

---

## 💡 ヒント

### コマンドの組み合わせ

効果的なワークフロー例：

1. `/setup` でゲーム環境を構築
2. `/role change` でキャラクター選択
3. `/poll` で重要な投票を実施
4. `/remind` でゲーム進行のリマインダー設定
5. `/archive` でゲーム終了後にアーカイブ

### エラーが出た場合

- Bot の権限を確認
- チャンネルやカテゴリのIDが正しいか確認
- [FAQ](./faq.md) を参照

---

## 📖 関連ドキュメント

- [ユースケース](./use-cases.md) - 実践的な活用例
- [よくある質問](./faq.md) - トラブルシューティング
